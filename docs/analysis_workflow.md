# 投資分析ワークフローと分析哲学

## 分析哲学：3つの利回り指標によるアプローチ

本プロジェクトにおける株式分析は、伝統的なPERやPBRといった指標が持つ問題点（赤字企業で計算不能、評価軸の不統一など）を克服し、より直感的で一貫性のある評価を行うため、以下の3つの「利回り」指標を中核に据える。

### 1. 3つのコア指標

| 新指標 | 英語名 | 計算式 | 概念 |
|---|---|---|---|
| **収益利回り** | Earnings Yield | EPS ÷ 株価 (PERの逆数) | 企業の利益創出力 |
| **純資産利回り**| Book-value Yield| BPS ÷ 株価 (PBRの逆数) | 企業の資産価値 |
| **配当利回り** | Dividend Yield | DPS ÷ 株価 | 株主への直接還元 |

このアプローチにより、すべての指標が「高いほど良い（割安・高効率）」という統一された基準で評価可能となり、数学的にも安定する。

### 2. 4次元プロットによる可視化分析

企業の状況を多角的に捉えるため、以下の4つの情報を統合したプロット分析を行う。

1. **横軸**: **収益利回り** (Earnings Yield) - 企業の収益力
2. **縦軸**: **純資産利回り** (Book-value Yield) - 企業の資産効率性（プロットの傾きがROEに相当）
3. **時間**: **時系列の軌跡** - 業績と評価の変化
4. **色**: **株価水準** - 割安・割高の判断（寒色:安値圏, 暖色:高値圏）

この可視化により、「高業績・高効率（プロット右上に位置）なのに、株価は割安（寒色）」といった絶好の投資機会を直感的に発見することを目指す。

### 3. 機械学習による最適化

将来的には、3つの利回り指標に機械学習を用いて最適な重み付け（α, β, γ）を行い、将来の株価リターンを予測する「総合利回りスコア」の構築を目指す。

**総合利回りスコア = α×配当利回り + β×収益利回り + γ×純資産利回り**

---

# 投資分析ワークフローの全体像

## フェーズ1：市場概観の把握

- **目的**: 分析対象である市場全体の構造やトレンドを把握し、後続フェーズの精度を高める。
- **手順**:
    1. 全上場銘柄の時価総額の合計推移を可視化し、TOPIXなどの主要指数と比較する。
    2. 現在の全上場銘柄の時価総額の分布をヒストグラムや箱ひげ図で可視化する。

## フェーズ2：分析モデルの構築（1銘柄での深掘り）

- **目的**: 再利用可能な「分析テンプレート」を確立する。
- **手順**:
    1. 代表的な銘柄を1つ選定する（例：トヨタ、ソニーなど）。
    2. その銘柄を対象に、時系列分析のプロセスを構築する。
        - **データ結合**: `join_asof`を使い、日々の株価データと決算データ（開示日基準）を結合する。通常の四半期決算だけでなく、業績修正の開示も「期」の区切りとし、開示時刻を考慮した「情報反映日（翌営業日）」を計算するロジックを組み込む。
        - **指標計算**:
            - **収益利回り、純資産利回り、配当利回り**を計算する。
            - VWAP（出来高加重平均）などの補助指標も計算する。
            - **各「期」（情報反映日から次の情報反映日の前日まで）ごとに、各種利回りの「始値・高値・安値・終値・平均値」といった統計量を作成する。**
            - **出来高については、発行済株式数との割合である「売買回転率」を計算し、各期ごとの「合計売買金額」や「平均日次売買金額」も算出する。**
        - **可視化**: 上記の「4次元プロット」を用いて、企業の状況を可視化する。時価総額などの推移も絶対値と規格化（インデックス化）の両方で可視化する。

## フェーズ3：スクリーニングと定量的評価（全銘柄への展開）

- **目的**: 広範な市場から、有望な候補銘柄群を効率的に発見し、比較評価する。
- **手順**:
    1. **スクリーニング**: **収益利回りと純資産利回りの2軸を時系列で評価する（例：過去10年の平均収益利回りが〇%以上、かつ平均純資産利回りが〇%以上など）**といった定量的基準を使い、全上場企業（約3900社）から数十社の候補リストを作成する。
    2. **定量的評価**: 絞り込んだ数十社に対して、**フェーズ2**で作成した「分析テンプレート」を適用する。**各期ごとの利回り統計量や「売買回転率」などを活用し、多角的に評価する。**
    3. **比較**: 各社のパフォーマンス（規格化時系列や4次元プロットの軌跡）などを横並びで比較し、さらに有望な数社に絞り込む。

## フェーズ4：定性的深掘りと最終判断（AIとの協業）

- **目的**: 定量的に有望な銘柄について、事業の実態や将来性、リスクを評価し、最終的な投資判断を下す。
- **手順**:
    1. **資料入手**: **フェーズ3**で選び抜かれた数社について、企業のIRサイトから最新の「決算短信」や「有価証券報告書」のPDFを入手する。
    2. **AIによる支援**: AI（大規模言語モデル）にPDFを読み込ませ、対話形式で分析を深める。
        - **要約**: 「決算の要点は？」「このセグメントの状況は？」
        - **情報抽出**: 「設備投資計画の金額は？」「リスク要因として何が挙げられている？」
        - **用語解説**: 「『のれん』とは？」
    3. **最終判断**: AIによる情報整理の支援を受けながら、人間が最終的にビジネスモデルの強み、経営者の質、競争環境といった定性的な要素を評価し、投資を決定する。