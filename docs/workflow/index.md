# 投資分析ワークフローの全体像

## フェーズ1：市場概観の把握

- **目的**: 分析対象である市場全体の構造やトレンドを把握し、後続フェーズの精度を高める。
- **手順**:
    1. 全上場銘柄の時価総額の合計推移を可視化し、TOPIXなどの主要指数と比較する。
    2. 現在の全上場銘柄の時価総額の分布をヒストグラムや箱ひげ図で可視化する。

## フェーズ2：分析モデルの構築（1銘柄での深掘り）

- **目的**: 再利用可能な「分析テンプレート」を確立する。
- **手順**:
    1. 代表的な銘柄を1つ選定する（例：トヨタ、ソニーなど）。
    2. その銘柄を対象に、時系列分析のプロセスを構築する。
        - **データ結合**: `join_asof`を使い、日々の株価データと決算データ（開示日基準）を結合する。通常の四半期決算だけでなく、業績修正の開示も「期」の区切りとし、開示時刻を考慮した「情報反映日（翌営業日）」を計算するロジックを組み込む。
        - **指標計算**:
            - **収益利回り、純資産利回り、配当利回り**を計算する。
            - VWAP（出来高加重平均）などの補助指標も計算する。
            - **各「期」（情報反映日から次の情報反映日の前日まで）ごとに、各種利回りの「始値・高値・安値・終値・平均値」といった統計量を作成する。**
            - **出来高については、発行済株式数との割合である「売買回転率」を計算し、各期ごとの「合計売買金額」や「平均日次売買金額」も算出する。**
        - **可視化**: 上記の「4次元プロット」を用いて、企業の状況を可視化する。時価総額などの推移も絶対値と規格化（インデックス化）の両方で可視化する。

## フェーズ3：スクリーニングと定量的評価（全銘柄への展開）

- **目的**: 広範な市場から、有望な候補銘柄群を効率的に発見し、比較評価する。
- **手順**:
    1. **スクリーニング**: **収益利回りと純資産利回りの2軸を時系列で評価する（例：過去10年の平均収益利回りが〇%以上、かつ平均純資産利回りが〇%以上など）**といった定量的基準を使い、全上場企業（約3900社）から数十社の候補リストを作成する。
    2. **定量的評価**: 絞り込んだ数十社に対して、**フェーズ2**で作成した「分析テンプレート」を適用する。**各期ごとの利回り統計量や「売買回転率」などを活用し、多角的に評価する。**
    3. **比較**: 各社のパフォーマンス（規格化時系列や4次元プロットの軌跡）などを横並びで比較し、さらに有望な数社に絞り込む。

## フェーズ4：定性的深掘りと最終判断（AIとの協業）

- **目的**: 定量的に有望な銘柄について、事業の実態や将来性、リスクを評価し、最終的な投資判断を下す。
- **手順**:
    1. **資料入手**: **フェーズ3**で選び抜かれた数社について、企業のIRサイトから最新の「決算短信」や「有価証券報告書」のPDFを入手する。
    2. **AIによる支援**: AI（大規模言語モデル）にPDFを読み込ませ、対話形式で分析を深める。
        - **要約**: 「決算の要点は？」「このセグメントの状況は？」
        - **情報抽出**: 「設備投資計画の金額は？」「リスク要因として何が挙げられている？」
        - **用語解説**: 「『のれん』とは？」
    3. **最終判断**: AIによる情報整理の支援を受けながら、人間が最終的にビジネスモデルの強み、経営者の質、競争環境といった定性的な要素を評価し、投資を決定する。
